-- DARK SCRIPT - ADMIN PANEL COMPLETO
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- ProteÃ§Ã£o mouse1click
if not mouse1click then
    mouse1click = function()
        pcall(function()
            local vim = game:GetService("VirtualInputManager")
            vim:SendMouseButtonEvent(0, 0, 0, true, game, 1)
            vim:SendMouseButtonEvent(0, 0, 0, false, game, 1)
        end)
    end
end

-- GUI
local gui = Instance.new("ScreenGui")
gui.Name = "DarkScript"
gui.ResetOnSpawn = false
gui.Parent = game:GetService("CoreGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.fromOffset(650, 450)
frame.Position = UDim2.new(0.5, -325, 0.5, -225)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Parent = gui
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)

local header = Instance.new("Frame")
header.Size = UDim2.new(1, 0, 0, 50)
header.BackgroundColor3 = Color3.fromRGB(139, 92, 246)
header.BorderSizePixel = 0
header.Parent = frame
Instance.new("UICorner", header).CornerRadius = UDim.new(0, 12)

local headerCover = Instance.new("Frame")
headerCover.Size = UDim2.new(1, 0, 0, 20)
headerCover.Position = UDim2.new(0, 0, 1, -20)
headerCover.BackgroundColor3 = Color3.fromRGB(139, 92, 246)
headerCover.BorderSizePixel = 0
headerCover.Parent = header

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -100, 1, 0)
title.Position = UDim2.new(0, 15, 0, 0)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.TextColor3 = Color3.new(1, 1, 1)
title.TextXAlignment = Enum.TextXAlignment.Left
title.Text = "âš¡ DARK SCRIPT PRO"
title.Parent = header

local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.fromOffset(40, 40)
closeBtn.Position = UDim2.new(1, -45, 0, 5)
closeBtn.Text = "X"
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 18
closeBtn.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
closeBtn.TextColor3 = Color3.new(1, 1, 1)
closeBtn.Parent = header
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 8)
closeBtn.MouseButton1Click:Connect(function() gui:Destroy() end)

local content = Instance.new("ScrollingFrame")
content.Size = UDim2.new(1, -20, 1, -70)
content.Position = UDim2.new(0, 10, 0, 60)
content.BackgroundTransparency = 1
content.BorderSizePixel = 0
content.ScrollBarThickness = 6
content.CanvasSize = UDim2.new(0, 0, 0, 0)
content.AutomaticCanvasSize = Enum.AutomaticSize.Y
content.Parent = frame

local layout = Instance.new("UIListLayout", content)
layout.Padding = UDim.new(0, 8)
layout.SortOrder = Enum.SortOrder.LayoutOrder

local function createButton(text, color, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -10, 0, 40)
    btn.Text = text
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 13
    btn.BackgroundColor3 = color
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.Parent = content
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    btn.MouseButton1Click:Connect(callback)
    return btn
end

-- FLY SYSTEM
local flying = false
local flySpeed = 50
local bodyGyro, bodyVelocity
local control = {F = 0, B = 0, L = 0, R = 0, U = 0, D = 0}

local function toggleFly()
    flying = not flying
    local char = LocalPlayer.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    
    if flying then
        bodyGyro = Instance.new("BodyGyro", hrp)
        bodyGyro.MaxTorque = Vector3.new(400000, 400000, 400000)
        bodyGyro.CFrame = hrp.CFrame
        bodyVelocity = Instance.new("BodyVelocity", hrp)
        bodyVelocity.MaxForce = Vector3.new(400000, 400000, 400000)
        bodyVelocity.Velocity = Vector3.new(0, 0, 0)
    else
        if bodyGyro then bodyGyro:Destroy() end
        if bodyVelocity then bodyVelocity:Destroy() end
    end
end

UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.W then control.F = 1 end
    if input.KeyCode == Enum.KeyCode.S then control.B = 1 end
    if input.KeyCode == Enum.KeyCode.A then control.L = 1 end
    if input.KeyCode == Enum.KeyCode.D then control.R = 1 end
    if input.KeyCode == Enum.KeyCode.Space then control.U = 1 end
    if input.KeyCode == Enum.KeyCode.LeftControl then control.D = 1 end
end)

UserInputService.InputEnded:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.W then control.F = 0 end
    if input.KeyCode == Enum.KeyCode.S then control.B = 0 end
    if input.KeyCode == Enum.KeyCode.A then control.L = 0 end
    if input.KeyCode == Enum.KeyCode.D then control.R = 0 end
    if input.KeyCode == Enum.KeyCode.Space then control.U = 0 end
    if input.KeyCode == Enum.KeyCode.LeftControl then control.D = 0 end
end)

RunService.RenderStepped:Connect(function()
    if flying then
        local char = LocalPlayer.Character
        if not char then return end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        
        local cam = workspace.CurrentCamera
        local moveVec = Vector3.zero
        moveVec = moveVec + cam.CFrame.LookVector * (control.F - control.B)
        moveVec = moveVec + cam.CFrame.RightVector * (control.R - control.L)
        moveVec = moveVec + Vector3.new(0, 1, 0) * (control.U - control.D)
        
        if moveVec.Magnitude > 0 then
            hrp.CFrame = hrp.CFrame + moveVec.Unit * flySpeed * 0.016
        end
    end
end)

local flyBtn = createButton("âœˆï¸ FLY: OFF", Color3.fromRGB(60, 60, 70), function()
    toggleFly()
    flyBtn.Text = flying and "âœˆï¸ FLY: ON" or "âœˆï¸ FLY: OFF"
    flyBtn.BackgroundColor3 = flying and Color3.fromRGB(0, 160, 90) or Color3.fromRGB(60, 60, 70)
end)

-- SPEED
local speedActive = false
local speedBtn = createButton("ğŸƒ SPEED: OFF", Color3.fromRGB(60, 60, 70), function()
    speedActive = not speedActive
    speedBtn.Text = speedActive and "ğŸƒ SPEED: ON" or "ğŸƒ SPEED: OFF"
    speedBtn.BackgroundColor3 = speedActive and Color3.fromRGB(0, 160, 90) or Color3.fromRGB(60, 60, 70)
end)

RunService.Heartbeat:Connect(function()
    if speedActive then
        local char = LocalPlayer.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then hum.WalkSpeed = 50 end
        end
    end
end)

-- NOCLIP
local noclip = false
local noclipBtn = createButton("ğŸŒ«ï¸ NOCLIP: OFF", Color3.fromRGB(60, 60, 70), function()
    noclip = not noclip
    noclipBtn.Text = noclip and "ğŸŒ«ï¸ NOCLIP: ON" or "ğŸŒ«ï¸ NOCLIP: OFF"
    noclipBtn.BackgroundColor3 = noclip and Color3.fromRGB(0, 160, 90) or Color3.fromRGB(60, 60, 70)
end)

RunService.Stepped:Connect(function()
    if noclip then
        local char = LocalPlayer.Character
        if char then
            for _, v in pairs(char:GetDescendants()) do
                if v:IsA("BasePart") then v.CanCollide = false end
            end
        end
    end
end)

-- INFINITE JUMP
local infJump = false
local infJumpBtn = createButton("ğŸ¦˜ INF JUMP: OFF", Color3.fromRGB(60, 60, 70), function()
    infJump = not infJump
    infJumpBtn.Text = infJump and "ğŸ¦˜ INF JUMP: ON" or "ğŸ¦˜ INF JUMP: OFF"
    infJumpBtn.BackgroundColor3 = infJump and Color3.fromRGB(0, 160, 90) or Color3.fromRGB(60, 60, 70)
end)

UserInputService.JumpRequest:Connect(function()
    if infJump then
        local char = LocalPlayer.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then hum:ChangeState(Enum.HumanoidStateType.Jumping) end
        end
    end
end)

-- AIMBOT
local aimbotEnabled = false
local aimbotFOV = 100

local function getClosestPlayer()
    local closestPlayer = nil
    local shortestDistance = aimbotFOV
    local mousePos = UserInputService:GetMouseLocation()
    
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local char = player.Character
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum and hum.Health > 0 then
                local head = char:FindFirstChild("Head")
                if head then
                    local screenPos, onScreen = Camera:WorldToViewportPoint(head.Position)
                    if onScreen and screenPos.Z > 0 then
                        local distance = (Vector2.new(screenPos.X, screenPos.Y) - mousePos).Magnitude
                        if distance < shortestDistance then
                            shortestDistance = distance
                            closestPlayer = player
                        end
                    end
                end
            end
        end
    end
    return closestPlayer
end

local aimbotBtn = createButton("ğŸ¯ AIMBOT: OFF", Color3.fromRGB(60, 60, 70), function()
    aimbotEnabled = not aimbotEnabled
    aimbotBtn.Text = aimbotEnabled and "ğŸ¯ AIMBOT: ON" or "ğŸ¯ AIMBOT: OFF"
    aimbotBtn.BackgroundColor3 = aimbotEnabled and Color3.fromRGB(255, 70, 70) or Color3.fromRGB(60, 60, 70)
end)

RunService.RenderStepped:Connect(function()
    if aimbotEnabled then
        local isRightClick = UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton2)
        if isRightClick then
            local target = getClosestPlayer()
            if target and target.Character then
                local head = target.Character:FindFirstChild("Head")
                if head then
                    Camera.CFrame = CFrame.new(Camera.CFrame.Position, head.Position)
                end
            end
        end
    end
end)

-- AUTO CLICKER
local autoClickerEnabled = false
local lastClickTime = 0

local clickerBtn = createButton("ğŸ–±ï¸ AUTO CLICKER: OFF", Color3.fromRGB(60, 60, 70), function()
    autoClickerEnabled = not autoClickerEnabled
    clickerBtn.Text = autoClickerEnabled and "ğŸ–±ï¸ AUTO CLICKER: ON" or "ğŸ–±ï¸ AUTO CLICKER: OFF"
    clickerBtn.BackgroundColor3 = autoClickerEnabled and Color3.fromRGB(0, 160, 220) or Color3.fromRGB(60, 60, 70)
end)

RunService.Heartbeat:Connect(function()
    if autoClickerEnabled then
        local currentTime = tick()
        if currentTime - lastClickTime >= 0.05 then
            mouse1click()
            lastClickTime = currentTime
        end
    end
end)

-- ESP AVANÃ‡ADO
local espEnabled = false
local espHighlights = {}
local espFolder = Instance.new("Folder", game.CoreGui)

local espBtn = createButton("ğŸ‘ï¸ ESP: OFF", Color3.fromRGB(60, 60, 70), function()
    espEnabled = not espEnabled
    espBtn.Text = espEnabled and "ğŸ‘ï¸ ESP: ON" or "ğŸ‘ï¸ ESP: OFF"
    espBtn.BackgroundColor3 = espEnabled and Color3.fromRGB(0, 255, 150) or Color3.fromRGB(60, 60, 70)
    if not espEnabled then
        for _, h in pairs(espHighlights) do
            if h then h:Destroy() end
        end
        espHighlights = {}
        espFolder:ClearAllChildren()
    end
end)

RunService.Heartbeat:Connect(function()
    if espEnabled then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then
                if not espHighlights[player] then
                    local highlight = Instance.new("Highlight")
                    highlight.Adornee = player.Character
                    highlight.FillColor = Color3.fromRGB(255, 0, 0)
                    highlight.OutlineColor = Color3.fromRGB(255, 0, 0)
                    highlight.FillTransparency = 0.5
                    highlight.OutlineTransparency = 0
                    highlight.Parent = player.Character
                    espHighlights[player] = highlight
                end
            end
        end
    end
end)

-- TRACERS
local tracersEnabled = false
local tracerGui = Instance.new("ScreenGui", game.CoreGui)

local tracersBtn = createButton("ğŸ“ TRACERS: OFF", Color3.fromRGB(60, 60, 70), function()
    tracersEnabled = not tracersEnabled
    tracersBtn.Text = tracersEnabled and "ğŸ“ TRACERS: ON" or "ğŸ“ TRACERS: OFF"
    tracersBtn.BackgroundColor3 = tracersEnabled and Color3.fromRGB(139, 92, 246) or Color3.fromRGB(60, 60, 70)
end)

RunService.RenderStepped:Connect(function()
    tracerGui:ClearAllChildren()
    if tracersEnabled then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then
                local hrp = player.Character:FindFirstChild("HumanoidRootPart")
                if hrp then
                    local screenPos, onScreen = Camera:WorldToViewportPoint(hrp.Position)
                    if onScreen and screenPos.Z > 0 then
                        local viewportSize = Camera.ViewportSize
                        local startX = viewportSize.X / 2
                        local startY = viewportSize.Y
                        local endX = screenPos.X
                        local endY = screenPos.Y
                        
                        local deltaX = endX - startX
                        local deltaY = endY - startY
                        local dist = math.sqrt(deltaX * deltaX + deltaY * deltaY)
                        local angle = math.deg(math.atan2(deltaY, deltaX))
                        
                        local line = Instance.new("Frame")
                        line.Size = UDim2.new(0, dist, 0, 2)
                        line.Position = UDim2.new(0, startX, 0, startY)
                        line.AnchorPoint = Vector2.new(0, 0.5)
                        line.Rotation = angle
                        line.BackgroundColor3 = Color3.fromRGB(139, 92, 246)
                        line.BorderSizePixel = 0
                        line.Parent = tracerGui
                    end
                end
            end
        end
    end
end)

-- FULLBRIGHT
createButton("ğŸ’¡ FULLBRIGHT", Color3.fromRGB(100, 50, 150), function()
    local lighting = game:GetService("Lighting")
    lighting.Brightness = 2
    lighting.ClockTime = 14
    lighting.FogEnd = 100000
    lighting.GlobalShadows = false
    lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
end)

-- GODMODE
local godmodeEnabled = false
local godmodeBtn = createButton("ğŸ›¡ï¸ GODMODE: OFF", Color3.fromRGB(60, 60, 70), function()
    godmodeEnabled = not godmodeEnabled
    godmodeBtn.Text = godmodeEnabled and "ğŸ›¡ï¸ GODMODE: ON" or "ğŸ›¡ï¸ GODMODE: OFF"
    godmodeBtn.BackgroundColor3 = godmodeEnabled and Color3.fromRGB(255, 100, 100) or Color3.fromRGB(60, 60, 70)
    if godmodeEnabled then
        local char = LocalPlayer.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then
                hum.MaxHealth = math.huge
                hum.Health = math.huge
            end
        end
    end
end)

-- ANTI-AFK
local antiAfk = false
local antiAfkBtn = createButton("â° ANTI-AFK: OFF", Color3.fromRGB(60, 60, 70), function()
    antiAfk = not antiAfk
    antiAfkBtn.Text = antiAfk and "â° ANTI-AFK: ON" or "â° ANTI-AFK: OFF"
    antiAfkBtn.BackgroundColor3 = antiAfk and Color3.fromRGB(0, 160, 90) or Color3.fromRGB(60, 60, 70)
    if antiAfk then
        local vu = game:GetService("VirtualUser")
        LocalPlayer.Idled:Connect(function()
            vu:CaptureController()
            vu:ClickButton2(Vector2.new())
        end)
    end
end)

-- BHOP
local bhopEnabled = false
local bhopBtn = createButton("ğŸ‡ BHOP: OFF", Color3.fromRGB(60, 60, 70), function()
    bhopEnabled = not bhopEnabled
    bhopBtn.Text = bhopEnabled and "ğŸ‡ BHOP: ON" or "ğŸ‡ BHOP: OFF"
    bhopBtn.BackgroundColor3 = bhopEnabled and Color3.fromRGB(0, 160, 90) or Color3.fromRGB(60, 60, 70)
end)

RunService.Heartbeat:Connect(function()
    if bhopEnabled then
        local char = LocalPlayer.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum and hum.MoveDirection.Magnitude > 0 then
                hum:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end
    end
end)

print("âœ… DARK SCRIPT PRO CARREGADO!")
print("ğŸ“Œ Pressione M para abrir/fechar")
print("ğŸ¯ Aimbot: Segure botÃ£o direito do mouse")
print("âœˆï¸ Fly: WASD + Space/Ctrl")

UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.M then
        frame.Visible = not frame.Visible
    end
end)
