-- CASAIS SCRIPTER - Admin Panel PRO
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

-- Sistema de Voo
_G.FlySystem = {
    flying = false,
    noclip = false,
    speed = 50,
    bodyGyro = nil,
    bodyVelocity = nil,
    control = {F=0, B=0, L=0, R=0, U=0, D=0}
}

function _G.FlySystem.toggleFly()
    _G.FlySystem.flying = not _G.FlySystem.flying
    local char = LocalPlayer.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    
    if _G.FlySystem.flying then
        _G.FlySystem.bodyGyro = Instance.new("BodyGyro", hrp)
        _G.FlySystem.bodyGyro.MaxTorque = Vector3.new(4e5, 4e5, 4e5)
        _G.FlySystem.bodyGyro.CFrame = hrp.CFrame
        _G.FlySystem.bodyVelocity = Instance.new("BodyVelocity", hrp)
        _G.FlySystem.bodyVelocity.MaxForce = Vector3.new(4e5, 4e5, 4e5)
        _G.FlySystem.bodyVelocity.Velocity = Vector3.zero
    else
        if _G.FlySystem.bodyGyro then _G.FlySystem.bodyGyro:Destroy() end
        if _G.FlySystem.bodyVelocity then _G.FlySystem.bodyVelocity:Destroy() end
    end
end

function _G.FlySystem.init()
    UserInputService.InputBegan:Connect(function(input, gpe)
        if gpe then return end
        if input.KeyCode == Enum.KeyCode.W then _G.FlySystem.control.F = 1
        elseif input.KeyCode == Enum.KeyCode.S then _G.FlySystem.control.B = 1
        elseif input.KeyCode == Enum.KeyCode.A then _G.FlySystem.control.L = 1
        elseif input.KeyCode == Enum.KeyCode.D then _G.FlySystem.control.R = 1
        elseif input.KeyCode == Enum.KeyCode.Space then _G.FlySystem.control.U = 1
        elseif input.KeyCode == Enum.KeyCode.LeftControl then _G.FlySystem.control.D = 1 end
    end)

    UserInputService.InputEnded:Connect(function(input, gpe)
        if gpe then return end
        if input.KeyCode == Enum.KeyCode.W then _G.FlySystem.control.F = 0
        elseif input.KeyCode == Enum.KeyCode.S then _G.FlySystem.control.B = 0
        elseif input.KeyCode == Enum.KeyCode.A then _G.FlySystem.control.L = 0
        elseif input.KeyCode == Enum.KeyCode.D then _G.FlySystem.control.R = 0
        elseif input.KeyCode == Enum.KeyCode.Space then _G.FlySystem.control.U = 0
        elseif input.KeyCode == Enum.KeyCode.LeftControl then _G.FlySystem.control.D = 0 end
    end)

    RunService.RenderStepped:Connect(function()
        local char = LocalPlayer.Character
        if not char then return end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        if _G.FlySystem.noclip then
            for _, v in pairs(char:GetDescendants()) do
                if v:IsA("BasePart") and v.CanCollide then v.CanCollide = false end
            end
        end

        if _G.FlySystem.flying and hrp then
            local cam = workspace.CurrentCamera
            local moveVec = Vector3.zero
            moveVec = moveVec + cam.CFrame.LookVector * (_G.FlySystem.control.F - _G.FlySystem.control.B)
            moveVec = moveVec + cam.CFrame.RightVector * (_G.FlySystem.control.R - _G.FlySystem.control.L)
            moveVec = moveVec + Vector3.new(0,1,0) * (_G.FlySystem.control.U - _G.FlySystem.control.D)
            if moveVec.Magnitude > 0 then
                hrp.CFrame = hrp.CFrame + moveVec.Unit * _G.FlySystem.speed
            end
        end
    end)
end

-- Interface
local gui = Instance.new("ScreenGui")
gui.Name = "AdminPanel"
gui.ResetOnSpawn = false
gui.Parent = LocalPlayer.PlayerGui

local frame = Instance.new("Frame")
frame.Size = UDim2.fromOffset(550, 380)
frame.Position = UDim2.new(0.5, -275, 0.5, -190)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Visible = true
frame.Parent = gui

local header = Instance.new("Frame")
header.Size = UDim2.new(1, 0, 0, 45)
header.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
header.BorderSizePixel = 0
header.Parent = frame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -50, 1, 0)
title.Position = UDim2.new(0, 10, 0, 0)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 18
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextXAlignment = Enum.TextXAlignment.Left
title.Text = "CASAIS SCRIPTER"
title.Parent = header

local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.fromOffset(35, 35)
closeBtn.Position = UDim2.new(1, -40, 0, 5)
closeBtn.Text = "X"
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 16
closeBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
closeBtn.BorderSizePixel = 0
closeBtn.Parent = header

local content = Instance.new("Frame")
content.Size = UDim2.new(1, -20, 1, -55)
content.Position = UDim2.new(0, 10, 0, 50)
content.BackgroundTransparency = 1
content.Parent = frame

local layout = Instance.new("UIListLayout", content)
layout.Padding = UDim.new(0, 8)
layout.SortOrder = Enum.SortOrder.LayoutOrder

local flyToggle = Instance.new("TextButton")
flyToggle.Size = UDim2.new(1, 0, 0, 50)
flyToggle.Text = "FLY: OFF"
flyToggle.Font = Enum.Font.GothamBold
flyToggle.TextSize = 16
flyToggle.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
flyToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
flyToggle.BorderSizePixel = 0
flyToggle.LayoutOrder = 1
flyToggle.Parent = content

local noclipToggle = Instance.new("TextButton")
noclipToggle.Size = UDim2.new(1, 0, 0, 50)
noclipToggle.Text = "NOCLIP: OFF"
noclipToggle.Font = Enum.Font.GothamBold
noclipToggle.TextSize = 16
noclipToggle.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
noclipToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
noclipToggle.BorderSizePixel = 0
noclipToggle.LayoutOrder = 2
noclipToggle.Parent = content

local speedFrame = Instance.new("Frame")
speedFrame.Size = UDim2.new(1, 0, 0, 60)
speedFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
speedFrame.BorderSizePixel = 0
speedFrame.LayoutOrder = 3
speedFrame.Parent = content

local speedLabel = Instance.new("TextLabel")
speedLabel.Size = UDim2.new(1, -10, 0, 20)
speedLabel.Position = UDim2.new(0, 5, 0, 5)
speedLabel.BackgroundTransparency = 1
speedLabel.Text = "VELOCIDADE: 50"
speedLabel.Font = Enum.Font.GothamBold
speedLabel.TextSize = 14
speedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
speedLabel.TextXAlignment = Enum.TextXAlignment.Left
speedLabel.Parent = speedFrame

local speedSlider = Instance.new("Frame")
speedSlider.Size = UDim2.new(1, -10, 0, 8)
speedSlider.Position = UDim2.new(0, 5, 0, 35)
speedSlider.BackgroundColor3 = Color3.fromRGB(60, 60, 75)
speedSlider.BorderSizePixel = 0
speedSlider.Parent = speedFrame

local speedFill = Instance.new("Frame")
speedFill.Size = UDim2.new(0.4, 0, 1, 0)
speedFill.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
speedFill.BorderSizePixel = 0
speedFill.Parent = speedSlider

local speedBtn = Instance.new("TextButton")
speedBtn.Size = UDim2.new(0, 18, 0, 18)
speedBtn.Position = UDim2.new(0.4, -9, 0.5, -9)
speedBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
speedBtn.Text = ""
speedBtn.BorderSizePixel = 0
speedBtn.Parent = speedSlider

local speedDragging = false
speedBtn.MouseButton1Down:Connect(function() speedDragging = true end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then speedDragging = false end
end)

RunService.RenderStepped:Connect(function()
    if speedDragging then
        local mousePos = UserInputService:GetMouseLocation().X
        local sliderPos = speedSlider.AbsolutePosition.X
        local sliderSize = speedSlider.AbsoluteSize.X
        local relativePos = math.clamp((mousePos - sliderPos) / sliderSize, 0, 1)
        _G.FlySystem.speed = math.floor(10 + (150 - 10) * relativePos)
        speedFill.Size = UDim2.new(relativePos, 0, 1, 0)
        speedBtn.Position = UDim2.new(relativePos, -9, 0.5, -9)
        speedLabel.Text = "VELOCIDADE: " .. _G.FlySystem.speed
    end
end)

local infoLabel = Instance.new("TextLabel")
infoLabel.Size = UDim2.new(1, 0, 0, 100)
infoLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
infoLabel.BorderSizePixel = 0
infoLabel.Font = Enum.Font.Gotham
infoLabel.TextSize = 13
infoLabel.TextColor3 = Color3.fromRGB(220, 220, 220)
infoLabel.TextWrapped = true
infoLabel.TextYAlignment = Enum.TextYAlignment.Top
infoLabel.Text = "\nCONTROLES:\n\nM - Abrir/Fechar\nF - Toggle Fly\nWASD - Movimento\nSpace/Ctrl - Subir/Descer"
infoLabel.LayoutOrder = 4
infoLabel.Parent = content

-- Eventos
flyToggle.MouseButton1Click:Connect(function()
    pcall(function()
        _G.FlySystem.toggleFly()
        flyToggle.Text = _G.FlySystem.flying and "FLY: ON" or "FLY: OFF"
        flyToggle.BackgroundColor3 = _G.FlySystem.flying and Color3.fromRGB(50, 150, 50) or Color3.fromRGB(50, 50, 65)
    end)
end)

noclipToggle.MouseButton1Click:Connect(function()
    pcall(function()
        _G.FlySystem.noclip = not _G.FlySystem.noclip
        noclipToggle.Text = _G.FlySystem.noclip and "NOCLIP: ON" or "NOCLIP: OFF"
        noclipToggle.BackgroundColor3 = _G.FlySystem.noclip and Color3.fromRGB(50, 150, 50) or Color3.fromRGB(50, 50, 65)
    end)
end)

closeBtn.MouseButton1Click:Connect(function()
    frame.Visible = false
end)

UserInputService.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == Enum.KeyCode.M then
        frame.Visible = not frame.Visible
    elseif input.KeyCode == Enum.KeyCode.F then
        pcall(function()
            _G.FlySystem.toggleFly()
            flyToggle.Text = _G.FlySystem.flying and "FLY: ON" or "FLY: OFF"
            flyToggle.BackgroundColor3 = _G.FlySystem.flying and Color3.fromRGB(50, 150, 50) or Color3.fromRGB(50, 50, 65)
        end)
    end
end)

-- InicializaÃ§Ã£o
pcall(function() _G.FlySystem.init() end)
print("âœ… Admin Panel carregado!")
print("ðŸ”‘ Pressione M para abrir")
