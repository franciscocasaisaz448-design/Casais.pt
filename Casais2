-- ‚ö° CASAIS SCRIPTER - Admin Panel PRO ‚ö°
-- üéØ Script Completo e Organizado

if not game or not game:GetService then warn("Execute no Roblox") return end

-- SERVI√áOS
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- COMPATIBILIDADE
local hasDrawing = pcall(function() return Drawing end)
local hasVIM = pcall(function() return game:GetService("VirtualInputManager") end)

-- VARI√ÅVEIS GLOBAIS
local selectedPlayer, spectating, panelVisible, currentTab = nil, false, false, nil
local playerButtons, tabContents, espHighlights, espBoxes, tracerLines = {}, {}, {}, {}, {}
local espEnabled, espBoxEnabled, tracersEnabled, nametagsEnabled = true, false, false, false
local espMaxDistance = 1000
local aimbotEnabled, aimbotFOV, aimbotSmooth, aimbotTarget = false, 80, 5, "Head"
local autoClickerEnabled, autoClickerSpeed = false, 50
local fovCircle = nil

-- SISTEMA DE VOO
_G.FlySystem = _G.FlySystem or {flying=false, noclip=false, speed=50, bodyGyro=nil, bodyVelocity=nil, control={F=0,B=0,L=0,R=0,U=0,D=0}}

function _G.FlySystem.toggleFly()
    _G.FlySystem.flying = not _G.FlySystem.flying
    local char = LocalPlayer.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    if _G.FlySystem.flying then
        _G.FlySystem.bodyGyro = Instance.new("BodyGyro", hrp)
        _G.FlySystem.bodyGyro.MaxTorque = Vector3.new(4e5, 4e5, 4e5)
        _G.FlySystem.bodyGyro.CFrame = hrp.CFrame
        _G.FlySystem.bodyVelocity = Instance.new("BodyVelocity", hrp)
        _G.FlySystem.bodyVelocity.MaxForce = Vector3.new(4e5, 4e5, 4e5)
        _G.FlySystem.bodyVelocity.Velocity = Vector3.zero
    else
        if _G.FlySystem.bodyGyro then _G.FlySystem.bodyGyro:Destroy() end
        if _G.FlySystem.bodyVelocity then _G.FlySystem.bodyVelocity:Destroy() end
    end
end

function _G.FlySystem.toggleNoclip() _G.FlySystem.noclip = not _G.FlySystem.noclip end

function _G.FlySystem.init()
    UserInputService.InputBegan:Connect(function(input, gpe)
        if gpe then return end
        if input.KeyCode == Enum.KeyCode.W then _G.FlySystem.control.F = 1
        elseif input.KeyCode == Enum.KeyCode.S then _G.FlySystem.control.B = 1
        elseif input.KeyCode == Enum.KeyCode.A then _G.FlySystem.control.L = 1
        elseif input.KeyCode == Enum.KeyCode.D then _G.FlySystem.control.R = 1
        elseif input.KeyCode == Enum.KeyCode.Space then _G.FlySystem.control.U = 1
        elseif input.KeyCode == Enum.KeyCode.LeftControl then _G.FlySystem.control.D = 1 end
    end)
    UserInputService.InputEnded:Connect(function(input, gpe)
        if gpe then return end
        if input.KeyCode == Enum.KeyCode.W then _G.FlySystem.control.F = 0
        elseif input.KeyCode == Enum.KeyCode.S then _G.FlySystem.control.B = 0
        elseif input.KeyCode == Enum.KeyCode.A then _G.FlySystem.control.L = 0
        elseif input.KeyCode == Enum.KeyCode.D then _G.FlySystem.control.R = 0
        elseif input.KeyCode == Enum.KeyCode.Space then _G.FlySystem.control.U = 0
        elseif input.KeyCode == Enum.KeyCode.LeftControl then _G.FlySystem.control.D = 0 end
    end)
    RunService.RenderStepped:Connect(function()
        local char = LocalPlayer.Character
        if not char then return end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end
        if _G.FlySystem.noclip then
            for _, v in pairs(char:GetDescendants()) do
                if v:IsA("BasePart") and v.CanCollide then v.CanCollide = false end
            end
        end
        if _G.FlySystem.flying and hrp then
            local cam = workspace.CurrentCamera
            local moveVec = Vector3.zero
            moveVec = moveVec + cam.CFrame.LookVector * (_G.FlySystem.control.F - _G.FlySystem.control.B)
            moveVec = moveVec + cam.CFrame.RightVector * (_G.FlySystem.control.R - _G.FlySystem.control.L)
            moveVec = moveVec + Vector3.new(0,1,0) * (_G.FlySystem.control.U - _G.FlySystem.control.D)
            if moveVec.Magnitude > 0 then hrp.CFrame = hrp.CFrame + moveVec.Unit * (_G.FlySystem.speed / 60) end
        end
    end)
end

-- FUN√á√ïES AUXILIARES
local function instantTPTo(player)
    if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            char.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame
        end
    end
end

local function startSpectate(player)
    if player and player.Character and player.Character:FindFirstChild("Humanoid") then
        spectating = player
        Camera.CameraSubject = player.Character.Humanoid
    end
end

local function stopSpectate()
    spectating = false
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        Camera.CameraSubject = LocalPlayer.Character.Humanoid
    end
end

local function getPlayerDistance(player)
    if not LocalPlayer.Character or not player.Character then return math.huge end
    local myPos = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    local theirPos = player.Character:FindFirstChild("HumanoidRootPart")
    if not myPos or not theirPos then return math.huge end
    return (myPos.Position - theirPos.Position).Magnitude
end

-- INTERFACE
local gui = Instance.new("ScreenGui")
gui.Name = "AdminPanel"
gui.ResetOnSpawn = false
gui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.fromOffset(600, 400)
frame.Position = UDim2.new(0.5, -300, 0.5, -200)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
frame.Active, frame.Draggable, frame.Visible = true, true, false
frame.Parent = gui
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 15)

local header = Instance.new("Frame")
header.Size = UDim2.new(1, 0, 0, 50)
header.BackgroundColor3 = Color3.fromRGB(139, 92, 246)
header.Parent = frame
Instance.new("UICorner", header).CornerRadius = UDim.new(0, 15)

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -60, 1, 0)
title.Position = UDim2.new(0, 10, 0, 0)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.TextColor3 = Color3.new(1, 1, 1)
title.TextXAlignment = Enum.TextXAlignment.Left
title.Text = "‚ö° CASAIS SCRIPTER PRO"
title.Parent = header

local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.fromOffset(40, 40)
closeBtn.Position = UDim2.new(1, -45, 0, 5)
closeBtn.Text = "‚úï"
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 18
closeBtn.BackgroundColor3 = Color3.fromRGB(239, 68, 68)
closeBtn.TextColor3 = Color3.new(1, 1, 1)
closeBtn.Parent = header
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 8)

local tabs = Instance.new("ScrollingFrame")
tabs.Size = UDim2.new(0, 150, 1, -95)
tabs.Position = UDim2.new(0, 15, 0, 65)
tabs.BackgroundTransparency = 1
tabs.BorderSizePixel = 0
tabs.ScrollBarThickness = 4
tabs.CanvasSize = UDim2.new(0, 0, 0, 0)
tabs.AutomaticCanvasSize = Enum.AutomaticSize.Y
tabs.Parent = frame

local tabsLayout = Instance.new("UIListLayout", tabs)
tabsLayout.Padding = UDim.new(0, 8)
tabsLayout.SortOrder = Enum.SortOrder.LayoutOrder

local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1, -180, 1, -75)
contentFrame.Position = UDim2.new(0, 170, 0, 65)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = frame

-- FUN√á√ïES DE CRIA√á√ÉO
local function makeTab(text, order)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, 0, 0, 35)
    btn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    btn.Text = text
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 14
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.LayoutOrder = order
    btn.Parent = tabs
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    local content = Instance.new("ScrollingFrame")
    content.Size = UDim2.new(1, 0, 1, 0)
    content.BackgroundTransparency = 1
    content.BorderSizePixel = 0
    content.ScrollBarThickness = 4
    content.Visible = false
    content.CanvasSize = UDim2.new(0, 0, 0, 0)
    content.AutomaticCanvasSize = Enum.AutomaticSize.Y
    content.Parent = contentFrame
    local layout = Instance.new("UIListLayout", content)
    layout.Padding = UDim.new(0, 10)
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    tabContents[text] = content
    btn.MouseButton1Click:Connect(function()
        for _, c in pairs(tabContents) do c.Visible = false end
        content.Visible = true
        currentTab = text
    end)
    return content
end

local function makeButton(parent, text, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, 0, 0, 40)
    btn.BackgroundColor3 = Color3.fromRGB(139, 92, 246)
    btn.Text = text
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 14
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.Parent = parent
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    btn.MouseButton1Click:Connect(callback)
    return btn
end

local function makeToggle(parent, text, callback)
    local container = Instance.new("Frame")
    container.Size = UDim2.new(1, 0, 0, 40)
    container.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    container.Parent = parent
    Instance.new("UICorner", container).CornerRadius = UDim.new(0, 8)
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, -60, 1, 0)
    label.Position = UDim2.new(0, 10, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.TextColor3 = Color3.new(1, 1, 1)
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = container
    local toggle = Instance.new("TextButton")
    toggle.Size = UDim2.fromOffset(50, 25)
    toggle.Position = UDim2.new(1, -55, 0.5, -12.5)
    toggle.BackgroundColor3 = Color3.fromRGB(239, 68, 68)
    toggle.Text = "OFF"
    toggle.Font = Enum.Font.GothamBold
    toggle.TextSize = 12
    toggle.TextColor3 = Color3.new(1, 1, 1)
    toggle.Parent = container
    Instance.new("UICorner", toggle).CornerRadius = UDim.new(0, 6)
    local state = false
    toggle.MouseButton1Click:Connect(function()
        state = not state
        toggle.BackgroundColor3 = state and Color3.fromRGB(34, 197, 94) or Color3.fromRGB(239, 68, 68)
        toggle.Text = state and "ON" or "OFF"
        callback(state)
    end)
    return toggle
end

-- ABAS
local playerTab = makeTab("üë• Players", 1)
local localTab = makeTab("üéÆ Local", 2)
local visionTab = makeTab("üëÅÔ∏è Vision", 3)
local miscTab = makeTab("‚öôÔ∏è Misc", 4)

-- ABA PLAYERS
local playerList = Instance.new("ScrollingFrame")
playerList.Size = UDim2.new(1, 0, 0, 200)
playerList.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
playerList.BorderSizePixel = 0
playerList.ScrollBarThickness = 4
playerList.CanvasSize = UDim2.new(0, 0, 0, 0)
playerList.AutomaticCanvasSize = Enum.AutomaticSize.Y
playerList.Parent = playerTab
Instance.new("UICorner", playerList).CornerRadius = UDim.new(0, 8)
local playerListLayout = Instance.new("UIListLayout", playerList)
playerListLayout.Padding = UDim.new(0, 5)

local function updatePlayerList()
    for _, btn in pairs(playerButtons) do btn:Destroy() end
    playerButtons = {}
    for _, player in pairs(Players:GetPlayers()) do
        local btn = Instance.new("TextButton")
        btn.Size = UDim2.new(1, -10, 0, 30)
        btn.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
        btn.Text = player.Name
        btn.Font = Enum.Font.Gotham
        btn.TextSize = 12
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Parent = playerList
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)
        btn.MouseButton1Click:Connect(function()
            selectedPlayer = player
            for _, b in pairs(playerButtons) do b.BackgroundColor3 = Color3.fromRGB(40, 40, 50) end
            btn.BackgroundColor3 = Color3.fromRGB(139, 92, 246)
        end)
        table.insert(playerButtons, btn)
    end
end

updatePlayerList()
Players.PlayerAdded:Connect(updatePlayerList)
Players.PlayerRemoving:Connect(updatePlayerList)

makeButton(playerTab, "üöÄ Teleport", function() if selectedPlayer then instantTPTo(selectedPlayer) end end)
makeButton(playerTab, "üëÅÔ∏è Spectate", function() if selectedPlayer then startSpectate(selectedPlayer) end end)
makeButton(playerTab, "üîô Stop Spectate", function() stopSpectate() end)

-- ABA LOCAL
makeToggle(localTab, "‚úàÔ∏è Fly", function(state) _G.FlySystem.toggleFly() end)
makeToggle(localTab, "üëª Noclip", function(state) _G.FlySystem.toggleNoclip() end)
makeButton(localTab, "‚ö° Speed +", function()
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("Humanoid") then char.Humanoid.WalkSpeed = char.Humanoid.WalkSpeed + 10 end
end)
makeButton(localTab, "üêå Speed -", function()
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("Humanoid") then char.Humanoid.WalkSpeed = math.max(16, char.Humanoid.WalkSpeed - 10) end
end)
makeButton(localTab, "üîÑ Reset Speed", function()
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("Humanoid") then char.Humanoid.WalkSpeed = 16 end
end)

-- ABA VISION
makeToggle(visionTab, "üëÅÔ∏è ESP", function(state) espEnabled = state end)
makeToggle(visionTab, "‚ñ° ESP Boxes", function(state) espBoxEnabled = state end)
makeToggle(visionTab, "üìè Tracers", function(state) tracersEnabled = state end)
makeToggle(visionTab, "üè∑Ô∏è Nametags", function(state) nametagsEnabled = state end)

-- ABA MISC
makeButton(miscTab, "üîÑ Respawn", function()
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("Humanoid") then char.Humanoid.Health = 0 end
end)
makeButton(miscTab, "üåô Full Bright", function()
    Lighting.Brightness = 2
    Lighting.ClockTime = 14
    Lighting.FogEnd = 100000
    Lighting.GlobalShadows = false
end)

-- ESP SYSTEM
local function updateESP()
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local distance = getPlayerDistance(player)
            if distance <= espMaxDistance then
                local char = player.Character
                local highlight = espHighlights[player]
                if not highlight then
                    highlight = Instance.new("Highlight")
                    highlight.Adornee = char
                    highlight.FillTransparency = 0.5
                    highlight.OutlineTransparency = 0
                    highlight.Parent = char
                    espHighlights[player] = highlight
                end
                if distance < 50 then
                    highlight.FillColor = Color3.fromRGB(255, 0, 0)
                    highlight.OutlineColor = Color3.fromRGB(255, 0, 0)
                elseif distance < 200 then
                    highlight.FillColor = Color3.fromRGB(255, 255, 0)
                    highlight.OutlineColor = Color3.fromRGB(255, 255, 0)
                else
                    highlight.FillColor = Color3.fromRGB(0, 255, 0)
                    highlight.OutlineColor = Color3.fromRGB(0, 255, 0)
                end
                highlight.Enabled = espEnabled
            else
                if espHighlights[player] then espHighlights[player]:Destroy() espHighlights[player] = nil end
            end
        end
    end
end

-- TRACERS
local function updateTracers()
    for _, line in pairs(tracerLines) do if line then line:Remove() end end
    tracerLines = {}
    if not tracersEnabled or not hasDrawing then return end
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local distance = getPlayerDistance(player)
            if distance <= espMaxDistance then
                local hrp = player.Character:FindFirstChild("HumanoidRootPart")
                if hrp then
                    local screenPos, onScreen = Camera:WorldToViewportPoint(hrp.Position)
                    if onScreen and screenPos.Z > 0 then
                        pcall(function()
                            local line = Drawing.new("Line")
                            line.From = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y)
                            line.To = Vector2.new(screenPos.X, screenPos.Y)
                            line.Color = distance < 50 and Color3.fromRGB(255, 0, 0) or distance < 200 and Color3.fromRGB(255, 255, 0) or Color3.fromRGB(0, 255, 0)
                            line.Thickness = 2
                            line.Transparency = 1
                            line.Visible = true
                            table.insert(tracerLines, line)
                        end)
                    end
                end
            end
        end
    end
end

-- LOOPS
RunService.Heartbeat:Connect(function() if espEnabled then updateESP() end end)
RunService.RenderStepped:Connect(function() updateTracers() end)

-- EVENTOS
closeBtn.MouseButton1Click:Connect(function() frame.Visible = false panelVisible = false end)
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.Insert or input.KeyCode == Enum.KeyCode.M then
        frame.Visible = not frame.Visible
        panelVisible = frame.Visible
        if panelVisible and not currentTab then
            for name, content in pairs(tabContents) do content.Visible = false end
            if tabContents["üë• Players"] then tabContents["üë• Players"].Visible = true currentTab = "üë• Players" end
        end
    elseif input.KeyCode == Enum.KeyCode.F then _G.FlySystem.toggleFly() end
end)

_G.FlySystem.init()

-- Abrir painel automaticamente na primeira vez
task.wait(0.5)
frame.Visible = true
panelVisible = true
if tabContents["üë• Players"] then tabContents["üë• Players"].Visible = true currentTab = "üë• Players" end

print("‚úÖ CASAIS SCRIPTER PRO | Pressione M ou INSERT para abrir/fechar")
